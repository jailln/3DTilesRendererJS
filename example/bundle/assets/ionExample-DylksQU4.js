import{S as f,a1 as h,af as A,W as x,a as T,d as y,j as m,Q as C}from"./three.module-llkpyLgW.js";import{G as I}from"./GLTFLoader-KDqsLDsn.js";import{D as R}from"./DRACOLoader-8fQNjor_.js";import{g as z}from"./lil-gui.module.min-DGepGIYL.js";import{E}from"./EnvironmentControls-lFV-KO1M.js";import{T as P}from"./TilesRenderer-COIzxhkT.js";import{C as k}from"./CesiumIonAuthPlugin-BfP1GAUz.js";import"./B3DMLoader-BbySC5wb.js";import"./readMagicBytes-C5ZyfJzm.js";import"./LoaderBase-QLlipkOW.js";import"./PNTSLoader-e5Dx7bf2.js";import"./I3DMLoader-DX535fGk.js";import"./CMPTLoader-BdZwSK3N.js";import"./GLTFExtensionLoader-bnHC9qPo.js";let i,c,a,r,e;const v=localStorage.getItem("ionApiKey")??"put-your-api-key-here",s={ionAssetId:"40866",ionAccessToken:v,reload:u};S();w();function D(o,t){const n=new C,d=new m().crossVectors(o,t);return n.x=d.x,n.y=d.y,n.z=d.z,n.w=1+o.clone().dot(t),n.normalize(),n}function L(){e.fetchOptions.mode="cors";const o=new R;o.setDecoderPath("https://unpkg.com/three@0.153.0/examples/jsm/libs/draco/gltf/");const t=new I(e.manager);t.setDRACOLoader(o),e.manager.addHandler(/\.gltf$/,t),a.add(e.group)}function u(){e&&(a.remove(e.group),e.dispose(),e=null),localStorage.setItem("ionApiKey",s.ionAccessToken),e=new P,e.registerPlugin(new k({apiToken:s.ionAccessToken,assetId:s.ionAssetId})),e.addEventListener("load-tile-set",()=>{const o=new y;e.getBoundingSphere(o);const t=o.center.clone(),n=t.length(),d=t.normalize(),g=new m(0,1,0),p=D(d,g);e.group.quaternion.x=p.x,e.group.quaternion.y=p.y,e.group.quaternion.z=p.z,e.group.quaternion.w=p.w,e.group.position.y=-n}),L()}function S(){a=new f;const o=new h(new Uint8Array(64*64*4).fill(255),64,64);o.mapping=A,o.needsUpdate=!0,a.environment=o,r=new x({antialias:!0}),r.setClearColor(1383455),document.body.appendChild(r.domElement),r.domElement.tabIndex=1,i=new T(60,window.innerWidth/window.innerHeight,1,1e5),i.position.set(100,100,-100),i.lookAt(0,0,0),c=new E(a,i,r.domElement),c.adjustHeight=!1,c.minDistance=1,c.maxAltitude=Math.PI,u(),l(),window.addEventListener("resize",l,!1);const t=new z;t.width=300;const n=t.addFolder("Ion");n.add(s,"ionAssetId"),n.add(s,"ionAccessToken"),n.add(s,"reload"),n.open()}function l(){i.aspect=window.innerWidth/window.innerHeight,i.updateProjectionMatrix(),r.setSize(window.innerWidth,window.innerHeight),r.setPixelRatio(window.devicePixelRatio)}function w(){requestAnimationFrame(w),e&&(c.update(),e.setCamera(i),e.setResolutionFromRenderer(i,r),i.updateMatrixWorld(),e.update(),r.render(a,i))}
