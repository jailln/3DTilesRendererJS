import{l as Be,m as Qe,E as $e,j as m,n as k,T as Y,Q as Me,o as Ae,V as f,i as U,R as Je,S as et,W as tt,a as nt}from"./three.module-llkpyLgW.js";import{G as ot}from"./GLTFLoader-KDqsLDsn.js";import{D as at}from"./DRACOLoader-8fQNjor_.js";import{g as it,t as st}from"./lil-gui.module.min-DGepGIYL.js";import{G as rt,a as lt,T as ct,W as pt}from"./TileCompressionPlugin-2xtjR4nV.js";import"./TilesRenderer-COIzxhkT.js";import"./B3DMLoader-BbySC5wb.js";import"./readMagicBytes-C5ZyfJzm.js";import"./LoaderBase-QLlipkOW.js";import"./PNTSLoader-e5Dx7bf2.js";import"./I3DMLoader-DX535fGk.js";import"./CMPTLoader-BdZwSK3N.js";import"./GLTFExtensionLoader-bnHC9qPo.js";const De={type:"change"},ae={type:"start"},Le={type:"end"},B=new Be,Re=new Qe,ut=Math.cos(70*U.DEG2RAD);class mt extends $e{constructor(p,O){super();const e=this;this.panPlane=new m(0,1,0),this.object=p,this.domElement=O,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new m,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:k.ROTATE,MIDDLE:k.DOLLY,RIGHT:k.PAN},this.touches={ONE:Y.ROTATE,TWO:Y.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return s.phi},this.getAzimuthalAngle=function(){return s.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",ne),this._domElementKeyEvents=t},this.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",ne),this._domElementKeyEvents=null},this.saveState=function(){e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=function(){e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(De),e.update(),i=o.NONE},this.update=function(){const t=new m,n=new Me().setFromUnitVectors(e.panPlane,new m(0,1,0)),l=n.clone().invert(),c=new m,u=new Me,X=new m,T=2*Math.PI;return function(){const Oe=e.object.position;t.copy(Oe).sub(e.target),t.applyQuaternion(n),s.setFromVector3(t),e.autoRotate&&i===o.NONE&&H(Ce()),e.enableDamping?(s.theta+=b.theta*e.dampingFactor,s.phi+=b.phi*e.dampingFactor):(s.theta+=b.theta,s.phi+=b.phi);let y=e.minAzimuthAngle,E=e.maxAzimuthAngle;isFinite(y)&&isFinite(E)&&(y<-Math.PI?y+=T:y>Math.PI&&(y-=T),E<-Math.PI?E+=T:E>Math.PI&&(E-=T),y<=E?s.theta=Math.max(y,Math.min(E,s.theta)):s.theta=s.theta>(y+E)/2?Math.max(y,s.theta):Math.min(E,s.theta)),s.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,s.phi)),s.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(S,e.dampingFactor):e.target.add(S),e.zoomToCursor&&W||e.object.isOrthographicCamera?s.radius=ee(s.radius):s.radius=ee(s.radius*M),t.setFromSpherical(s),t.applyQuaternion(l),Oe.copy(e.target).add(t),e.object.lookAt(e.target),e.enableDamping===!0?(b.theta*=1-e.dampingFactor,b.phi*=1-e.dampingFactor,S.multiplyScalar(1-e.dampingFactor)):(b.set(0,0,0),S.set(0,0,0));let V=!1;if(e.zoomToCursor&&W){let z=null;if(e.object.isPerspectiveCamera){const F=t.length();z=ee(F*M);const q=F-z;e.object.position.addScaledVector(se,q),e.object.updateMatrixWorld()}else if(e.object.isOrthographicCamera){const F=new m(w.x,w.y,0);F.unproject(e.object),e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/M)),e.object.updateProjectionMatrix(),V=!0;const q=new m(w.x,w.y,0);q.unproject(e.object),e.object.position.sub(q).add(F),e.object.updateMatrixWorld(),z=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;z!==null&&(this.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(z).add(e.object.position):(B.origin.copy(e.object.position),B.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.panPlane.dot(B.direction))<ut?p.lookAt(e.target):(Re.setFromNormalAndCoplanarPoint(e.panPlane,e.target),B.intersectPlane(Re,e.target))))}else e.object.isOrthographicCamera&&(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/M)),e.object.updateProjectionMatrix(),V=!0);return M=1,W=!1,V||c.distanceToSquared(e.object.position)>ie||8*(1-u.dot(e.object.quaternion))>ie||X.distanceToSquared(e.target)>0?(e.dispatchEvent(De),c.copy(e.object.position),u.copy(e.object.quaternion),X.copy(e.target),V=!1,!0):!1}}(),this.dispose=function(){e.domElement.removeEventListener("contextmenu",we),e.domElement.removeEventListener("pointerdown",Ee),e.domElement.removeEventListener("pointercancel",_),e.domElement.removeEventListener("wheel",Pe),e.domElement.removeEventListener("pointermove",te),e.domElement.removeEventListener("pointerup",_),e._domElementKeyEvents!==null&&(e._domElementKeyEvents.removeEventListener("keydown",ne),e._domElementKeyEvents=null)};const o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let i=o.NONE;const ie=1e-6,s=new Ae,b=new Ae;let M=1;const S=new m,A=new f,D=new f,x=new f,L=new f,R=new f,j=new f,N=new f,C=new f,K=new f,se=new m,w=new f;let W=!1;const a=[],Z={};function Ce(){return 2*Math.PI/60/60*e.autoRotateSpeed}function v(){return Math.pow(.95,e.zoomSpeed)}function H(t){b.theta-=t}function G(t){b.phi-=t}const re=function(){const t=new m;return function(l,c){t.setFromMatrixColumn(c,0),t.multiplyScalar(-l),S.add(t)}}(),le=function(){const t=new m;return function(l,c){e.screenSpacePanning===!0?t.setFromMatrixColumn(c,1):(t.setFromMatrixColumn(c,0),t.crossVectors(e.panPlane,t)),t.multiplyScalar(l),S.add(t)}}(),I=function(){const t=new m;return function(l,c){const u=e.domElement;if(e.object.isPerspectiveCamera){const X=e.object.position;t.copy(X).sub(e.target);let T=t.length();T*=Math.tan(e.object.fov/2*Math.PI/180),re(2*l*T/u.clientHeight,e.object.matrix),le(2*c*T/u.clientHeight,e.object.matrix)}else e.object.isOrthographicCamera?(re(l*(e.object.right-e.object.left)/e.object.zoom/u.clientWidth,e.object.matrix),le(c*(e.object.top-e.object.bottom)/e.object.zoom/u.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}}();function J(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?M/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function ce(t){e.object.isPerspectiveCamera||e.object.isOrthographicCamera?M*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function pe(t){if(!e.zoomToCursor)return;W=!0;const n=t.clientX-e.domElement.clientLeft,l=t.clientY-e.domElement.clientTop,c=e.domElement.clientWidth,u=e.domElement.clientHeight;w.x=n/c*2-1,w.y=-(l/u)*2+1,se.set(w.x,w.y,1).unproject(p).sub(p.position).normalize()}function ee(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function ue(t){A.set(t.clientX,t.clientY)}function Ie(t){pe(t),N.set(t.clientX,t.clientY)}function me(t){L.set(t.clientX,t.clientY)}function ke(t){D.set(t.clientX,t.clientY),x.subVectors(D,A).multiplyScalar(e.rotateSpeed);const n=e.domElement;H(2*Math.PI*x.x/n.clientHeight),G(2*Math.PI*x.y/n.clientHeight),A.copy(D),e.update()}function Ye(t){C.set(t.clientX,t.clientY),K.subVectors(C,N),K.y>0?J(v()):K.y<0&&ce(v()),N.copy(C),e.update()}function Ke(t){R.set(t.clientX,t.clientY),j.subVectors(R,L).multiplyScalar(e.panSpeed),I(j.x,j.y),L.copy(R),e.update()}function He(t){pe(t),t.deltaY<0?ce(v()):t.deltaY>0&&J(v()),e.update()}function _e(t){let n=!1;switch(t.code){case e.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?G(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):I(0,e.keyPanSpeed),n=!0;break;case e.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?G(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):I(0,-e.keyPanSpeed),n=!0;break;case e.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?H(2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):I(e.keyPanSpeed,0),n=!0;break;case e.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?H(-2*Math.PI*e.rotateSpeed/e.domElement.clientHeight):I(-e.keyPanSpeed,0),n=!0;break}n&&(t.preventDefault(),e.update())}function de(){if(a.length===1)A.set(a[0].pageX,a[0].pageY);else{const t=.5*(a[0].pageX+a[1].pageX),n=.5*(a[0].pageY+a[1].pageY);A.set(t,n)}}function he(){if(a.length===1)L.set(a[0].pageX,a[0].pageY);else{const t=.5*(a[0].pageX+a[1].pageX),n=.5*(a[0].pageY+a[1].pageY);L.set(t,n)}}function fe(){const t=a[0].pageX-a[1].pageX,n=a[0].pageY-a[1].pageY,l=Math.sqrt(t*t+n*n);N.set(0,l)}function ze(){e.enableZoom&&fe(),e.enablePan&&he()}function Fe(){e.enableZoom&&fe(),e.enableRotate&&de()}function ge(t){if(a.length==1)D.set(t.pageX,t.pageY);else{const l=oe(t),c=.5*(t.pageX+l.x),u=.5*(t.pageY+l.y);D.set(c,u)}x.subVectors(D,A).multiplyScalar(e.rotateSpeed);const n=e.domElement;H(2*Math.PI*x.x/n.clientHeight),G(2*Math.PI*x.y/n.clientHeight),A.copy(D)}function be(t){if(a.length===1)R.set(t.pageX,t.pageY);else{const n=oe(t),l=.5*(t.pageX+n.x),c=.5*(t.pageY+n.y);R.set(l,c)}j.subVectors(R,L).multiplyScalar(e.panSpeed),I(j.x,j.y),L.copy(R)}function ye(t){const n=oe(t),l=t.pageX-n.x,c=t.pageY-n.y,u=Math.sqrt(l*l+c*c);C.set(0,u),K.set(0,Math.pow(C.y/N.y,e.zoomSpeed)),J(K.y),N.copy(C)}function Ue(t){e.enableZoom&&ye(t),e.enablePan&&be(t)}function We(t){e.enableZoom&&ye(t),e.enableRotate&&ge(t)}function Ee(t){e.enabled!==!1&&(a.length===0&&(e.domElement.setPointerCapture(t.pointerId),e.domElement.addEventListener("pointermove",te),e.domElement.addEventListener("pointerup",_)),Ve(t),t.pointerType==="touch"?Ge(t):Ze(t))}function te(t){e.enabled!==!1&&(t.pointerType==="touch"?Xe(t):ve(t))}function _(t){qe(t),a.length===0&&(e.domElement.releasePointerCapture(t.pointerId),e.domElement.removeEventListener("pointermove",te),e.domElement.removeEventListener("pointerup",_)),e.dispatchEvent(Le),i=o.NONE}function Ze(t){let n;switch(t.button){case 0:n=e.mouseButtons.LEFT;break;case 1:n=e.mouseButtons.MIDDLE;break;case 2:n=e.mouseButtons.RIGHT;break;default:n=-1}switch(n){case k.DOLLY:if(e.enableZoom===!1)return;Ie(t),i=o.DOLLY;break;case k.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;me(t),i=o.PAN}else{if(e.enableRotate===!1)return;ue(t),i=o.ROTATE}break;case k.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;ue(t),i=o.ROTATE}else{if(e.enablePan===!1)return;me(t),i=o.PAN}break;default:i=o.NONE}i!==o.NONE&&e.dispatchEvent(ae)}function ve(t){switch(i){case o.ROTATE:if(e.enableRotate===!1)return;ke(t);break;case o.DOLLY:if(e.enableZoom===!1)return;Ye(t);break;case o.PAN:if(e.enablePan===!1)return;Ke(t);break}}function Pe(t){e.enabled===!1||e.enableZoom===!1||i!==o.NONE||(t.preventDefault(),e.dispatchEvent(ae),He(t),e.dispatchEvent(Le))}function ne(t){e.enabled===!1||e.enablePan===!1||_e(t)}function Ge(t){switch(Te(t),a.length){case 1:switch(e.touches.ONE){case Y.ROTATE:if(e.enableRotate===!1)return;de(),i=o.TOUCH_ROTATE;break;case Y.PAN:if(e.enablePan===!1)return;he(),i=o.TOUCH_PAN;break;default:i=o.NONE}break;case 2:switch(e.touches.TWO){case Y.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;ze(),i=o.TOUCH_DOLLY_PAN;break;case Y.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;Fe(),i=o.TOUCH_DOLLY_ROTATE;break;default:i=o.NONE}break;default:i=o.NONE}i!==o.NONE&&e.dispatchEvent(ae)}function Xe(t){switch(Te(t),i){case o.TOUCH_ROTATE:if(e.enableRotate===!1)return;ge(t),e.update();break;case o.TOUCH_PAN:if(e.enablePan===!1)return;be(t),e.update();break;case o.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;Ue(t),e.update();break;case o.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;We(t),e.update();break;default:i=o.NONE}}function we(t){e.enabled!==!1&&t.preventDefault()}function Ve(t){a.push(t)}function qe(t){delete Z[t.pointerId];for(let n=0;n<a.length;n++)if(a[n].pointerId==t.pointerId){a.splice(n,1);return}}function Te(t){let n=Z[t.pointerId];n===void 0&&(n=new f,Z[t.pointerId]=n),n.set(t.pageX,t.pageY)}function oe(t){const n=t.pointerId===a[0].pointerId?a[1]:a[0];return Z[n.pointerId]}e.domElement.addEventListener("contextmenu",we),e.domElement.addEventListener("pointerdown",Ee),e.domElement.addEventListener("pointercancel",_),e.domElement.addEventListener("wheel",Pe,{passive:!1}),this.update()}}let d,g,Q,P,r;const dt=new Je;dt.firstHitOnly=!0;const ht=localStorage.getItem("googleApiKey")??"put-your-api-key-here",$={apiKey:ht,reload:je};ft();Ne();function je(){localStorage.setItem("googleApiKey",$.apiKey),r&&(Q.remove(r.group),r.dispose(),r=null),r=new rt,r.registerPlugin(new lt({apiToken:$.apiKey})),r.registerPlugin(new ct),r.setLatLonToYUp(35.6586*U.DEG2RAD,139.7454*U.DEG2RAD);const h=new at;h.setDecoderPath("https://unpkg.com/three@0.153.0/examples/jsm/libs/draco/gltf/");const p=new ot(r.manager);p.setDRACOLoader(h),r.manager.addHandler(/\.gltf$/,p),Q.add(r.group),r.setResolutionFromRenderer(d,P),r.setCamera(d)}function ft(){Q=new et,P=new tt({antialias:!0}),P.setClearColor(1383455),document.body.appendChild(P.domElement),d=new nt(60,window.innerWidth/window.innerHeight,100,16e5),d.position.set(1e3,1e3,1e3).multiplyScalar(.5),g=new mt(d,P.domElement),g.minDistance=500,g.maxDistance=1e4*2,g.minPolarAngle=0,g.maxPolarAngle=3*Math.PI/8,g.enableDamping=!0,g.autoRotate=!0,g.autoRotateSpeed=.5,g.enablePan=!1,je(),Se(),window.addEventListener("resize",Se,!1),window.addEventListener("hashchange",xe);const h=new it;h.width=300,h.add($,"apiKey"),h.add($,"reload"),h.open(),xe()}function Se(){d.aspect=window.innerWidth/window.innerHeight,P.setSize(window.innerWidth,window.innerHeight),d.updateProjectionMatrix(),P.setPixelRatio(window.devicePixelRatio)}function xe(){const p=window.location.hash.replace(/^#/,"").split(/,/g).map(o=>parseFloat(o));if(p.length!==2||p.findIndex(o=>Number.isNaN(o))!==-1)return;const[O,e]=p;r.setLatLonToYUp(O*U.DEG2RAD,e*U.DEG2RAD)}function Ne(){requestAnimationFrame(Ne),r&&(g.update(),r.setResolutionFromRenderer(d,P),r.setCamera(d),d.updateMatrixWorld(),r.update(),gt())}function gt(){if(P.render(Q,d),r){const h=r.group.matrixWorld.clone().invert(),p=d.position.clone().applyMatrix4(h),O={};pt.getPositionToCartographic(p,O),document.getElementById("credits").innerText=st(O.lat,O.lon)+`
`+r.getCreditsString()}}
